# wp-aws

###### Create your Wordpress cluster in AWS in just a minute/two

### Requirements
- **Python 3**
  - ~~**venv**~~ - will be installed automatically
- ~~**Ansible, Terraform**~~ - will be installed automatically

### Usage
Clone this project, edit desired values in **vars.yml**, then
```
$ ./run.sh
```

##### If you want to be able to SSH into the created VMs using your key, make sure to also edit _ssh-key_ variable

### General info
- The script first deploys the network resources and the VMs with enabled internet access. After the configuration management part is done, the database internet access gets completely disabled and remains open only on the database port defined in **vars.yml** and allows connections only from the created web servers
- When you run **__./run.sh__**, a build directory with random ID wil be created for this specific installation of the infrastructure. It will be saved in your home directory **~/<build_id>**, see also steps for destroying below
- The scheduled database optimization script for the tables: **scripts/optimize_tables.sh**
- In addition to the main idea, I've also decided to create those helper scripts
  - **parser.py** - Used to pass variables from vars.yaml as ansible, terraform and bash CLI args as **./python3 parser.py parse_vars**. There's also another file - **config/vars_config.yml** which contains all manual documentation and destination of each variable and tells the parser which variable should go where by using the **tags** key for each. The script can also be used manually like this **python3 ./parser.py update_docs** to update both this file on the bottom and the **vars.yml** file itself, whenever there is a new variable introduced.
  - **create_inventory.py** - I've decided to rely on a script that creates an ansible inventory to do the configuration management part, instead of using the ec2 inventory script. This script takes output values from terraform and creates the inventory.
  

#### Removing the cluster
You can remove everything created by the automation by going to the build directory and running
```
$ ./destroy.sh
```

#### Variables in vars.yml
This section was automatically generated by parser.py - please do not edit edit it
